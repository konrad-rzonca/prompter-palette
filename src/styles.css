@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== Root & layout variables ===== */
:root {
    color-scheme: light;

    /* Central content width (matches max-w-6xl = 72rem) */
    --content-max: 72rem;

    /* Header & topbar dynamic measurements (JS updates --topbar-h) */
    --header-h: 56px;  /* header height */
    --topbar-h: 88px;  /* default; TopPrompt measures actual height */

    /* Side-rail geometry */
    --rail-gap: 16px;
    --rail-w: 280px;

    /* Scrollbar palette (light) */
    --sb-track: #e5e7eb;   /* slate-200 */
    --sb-thumb: #9ca3af;   /* slate-400 */
    --sb-thumb-hover: #6b7280; /* slate-500 */
}
.dark {
    /* Scrollbar palette (dark) */
    --sb-track: #0f172a;       /* slate-900 */
    --sb-thumb: #334155;       /* slate-700 */
    --sb-thumb-hover: #475569; /* slate-600 */
}

/* Global scrollbar styling (Firefox) */
* {
    scrollbar-width: thin;
    scrollbar-color: var(--sb-thumb) var(--sb-track);
}

/* Global scrollbar styling (WebKit/Blink) */
*::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}
*::-webkit-scrollbar-track {
    background: var(--sb-track);
    border-radius: 9999px;
}
*::-webkit-scrollbar-thumb {
    background-color: var(--sb-thumb);
    border-radius: 9999px;
    border: 3px solid var(--sb-track);
}
*::-webkit-scrollbar-thumb:hover {
    background-color: var(--sb-thumb-hover);
}

/* Utility to hide scrollbars entirely for specific elements (e.g., prompt textareas) */
.no-scrollbar {
    scrollbar-width: none; /* Firefox */
}
.no-scrollbar::-webkit-scrollbar {
    display: none; /* WebKit/Blink */
}

/* ===== Base atoms ===== */
.card { @apply bg-white dark:bg-slate-900 rounded-2xl shadow-soft border border-slate-200 dark:border-slate-800; }

.btn         { @apply inline-flex items-center justify-center rounded-xl px-3 py-2 text-sm font-medium transition; }
/* Subdued primary in dark mode */
.btn-primary { @apply bg-slate-900 text-white hover:bg-slate-800 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600; }
.btn-outline { @apply border border-slate-300 text-slate-800 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-800; }
.btn-light   { @apply bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700; }
.btn-ghost   { @apply text-slate-800 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800; }

.input { @apply w-full rounded-xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-sm text-slate-900 dark:text-slate-100 outline-none ring-0 focus:border-slate-400 dark:focus:border-slate-500; }

/* prevent manual resize handles on textareas styled as .input */
textarea.input { resize: none; }

.dot      { @apply inline-block w-2 h-2 rounded-full; }
.dot-grad { @apply bg-blue-600 dark:bg-blue-500; }
.dot-non  { @apply bg-amber-600 dark:bg-amber-500; }

/* Compact, consistent axis cards */
.axis-head { @apply flex items-center gap-2; }
.axis-title { @apply text-xs font-semibold text-slate-900 dark:text-slate-100 truncate; }
.axis-body { @apply mt-3 space-y-2; }

/* Group headers & layout */
.group-head { @apply flex items-center gap-2 text-xs font-semibold text-slate-900 dark:text-slate-100 px-1; }
.group-wrap { @apply grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3; }

/* Segmented control (filters) */
.segmented { @apply grid grid-cols-3 gap-1 p-1 rounded-xl bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700; }
.segmented button { @apply text-xs font-medium px-2 py-1.5 rounded-lg text-slate-800 dark:text-slate-200; }
.segmented button[aria-pressed="true"] { @apply bg-white dark:bg-slate-900 shadow border border-slate-200 dark:border-slate-700 text-slate-900 dark:text-slate-100; }

/* ===== Top prompt bar ===== */
.topbar {
    position: sticky;
    top: var(--header-h);
    z-index: 40;
    backdrop-filter: blur(6px);
    background: rgba(255,255,255,0.9);
    border-bottom: 1px solid rgb(226,232,240);
}
.dark .topbar {
    background: rgba(2,6,23,0.9);
    border-bottom-color: rgb(30,41,59);
}

/* ===== Side rails ===== */
.side-rail {
    position: fixed;
    width: var(--rail-w);
    top: calc(var(--header-h) + var(--topbar-h) + 16px);
    z-index: 30;
}
@media (min-width: 1280px) {
    .side-left  { left:  calc(50% - var(--content-max)/2 - var(--rail-gap) - var(--rail-w)); }
    .side-right { right: calc(50% - var(--content-max)/2 - var(--rail-gap) - var(--rail-w)); }
}
@media (max-width: 1279.98px) {
    .side-rail { display: none; }
}

/* ===== Discrete slider ===== */
.dslider { @apply w-full select-none py-2; }
.dslider-track { @apply relative h-1.5 rounded-full bg-slate-200 dark:bg-slate-700 cursor-pointer; }
.dslider-fill  { @apply absolute left-0 top-0 h-full rounded-full bg-blue-600 dark:bg-blue-500; pointer-events:none; transition: width 100ms ease; }
.dslider-stops { @apply absolute inset-0 w-full h-full flex items-center justify-between; pointer-events:none; }
.dslider-stop  { @apply absolute h-full -translate-x-1/2 flex items-center; }
.dslider-stop-dot { @apply w-1.5 h-1.5 rounded-full bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600; pointer-events:auto; }

.dslider-thumb {
    @apply absolute top-1/2 -translate-x-1/2 -translate-y-1/2 w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400 shadow border-2 border-white dark:border-slate-900 z-10 cursor-grab;
    transition: left 100ms ease, transform 150ms ease;
}
.dslider-thumb.dragging { @apply cursor-grabbing scale-110; transition: transform 150ms ease; }

/* Tags */
.term      { @apply rounded-lg border border-slate-300 dark:border-slate-700 px-2.5 py-1.5 text-xs text-slate-900 dark:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-800 cursor-pointer; }
.term.sel  { @apply bg-slate-800 text-slate-100 border-slate-800 dark:bg-slate-700 dark:text-slate-100 dark:border-slate-700; }

/* Focus */
:focus-visible { outline: 2px solid rgb(15,23,42); outline-offset: 2px; }
.dark :focus-visible { outline-color: rgb(226,232,240); }

/* Tooltips */
.tooltip-container { @apply relative inline-flex; }
.tooltip-popup { @apply absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 dark:bg-slate-700 text-white text-xs font-medium rounded-md shadow-lg whitespace-nowrap z-50 transition-opacity duration-75; }
.tooltip-hidden { @apply opacity-0 pointer-events-none; }
.tooltip-visible { @apply opacity-100; }
.tooltip-arrow   { @apply absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-x-4 border-x-transparent border-t-4 border-t-slate-800 dark:border-t-slate-700; }

/* ===== Theme picker: tight 3-part capsule, mid width (between original and 2×) ===== */
.seg3 {
    @apply grid grid-cols-3 rounded-full overflow-hidden border border-slate-300 dark:border-slate-700;
    width: 12rem;       /* mid width */
    max-width: 100%;
}
.seg3 button {
    @apply h-9 w-full flex items-center justify-center select-none
    bg-white text-slate-700 dark:bg-slate-900 dark:text-slate-200;
}
.seg3 button + button { @apply border-l border-slate-300 dark:border-slate-700; }
.seg3 button:hover { @apply bg-slate-100 dark:bg-slate-800; }
.seg3 button[aria-pressed="true"] { @apply bg-slate-900 text-white dark:bg-slate-700 dark:text-white; }
.topbar { overflow: visible; }
